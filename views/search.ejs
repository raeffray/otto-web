<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Search</title>
    <meta name="description" content="">
    <meta name="author" content="">
    <link href="stylesheets/style.css" rel="stylesheet">
    
    
    <style type="text/css">
     html {height:100%}
     body {height:100%;margin:0;padding:0}
     #googleMap {height:100%}
    </style>
    <script src="http://maps.googleapis.com/maps/api/js?key=AIzaSyAkklQyRjr1Jnm7UzTXgF_St_GrmEKI_Vs&sensor=false">
    </script>
    <script>
     
     var map;
     var centre = new google.maps.LatLng(51.508742,-0.120850);

     function getLocation() {
       if (navigator.geolocation) {
	 navigator.geolocation.getCurrentPosition(showPosition);
       }
       else {
	 x.innerHTML="Geolocation is not supported by this browser.";
	 setControls();
       }
     }

     function showPosition(position) {
       centre = new google.maps.LatLng(position.coords.latitude,position.coords.longitude);
       setControls();
     }
 
     
     // Add a Home control that returns the user to London
     function HomeControl(controlDiv, map) {

       controlDiv.style.padding = '5px';
       var controlUI = document.createElement('div');
       controlUI.style.backgroundColor = 'gray';
       controlUI.style.border='1px solid';
       controlUI.style.cursor = 'pointer';
       controlUI.style.textAlign = 'center';
       controlUI.title = 'Set map to London';
       controlDiv.appendChild(controlUI);
       var controlText = document.createElement('div');
       controlText.style.fontFamily='Arial,sans-serif';
       controlText.style.fontSize='12px';
       controlText.style.paddingLeft = '4px';
       controlText.style.paddingRight = '4px';
       controlText.innerHTML = '<b>Home<b>'
       controlUI.appendChild(controlText);
       
       // Setup click-event listener: simply set the map to London
       google.maps.event.addDomListener(controlUI, 'click', function() {
	 map.setCenter(centre);
       });
     }
     
     function initialize() {
       getLocation();
     }

     function setControls(){
       
       var mapDiv = document.getElementById('googleMap');
       var myOptions = {
	 zoom: 14,
	 center: centre,
	 mapTypeId: google.maps.MapTypeId.ROADMAP
       }

       map = new google.maps.Map(mapDiv, myOptions); 
       // Create a DIV to hold the control and call HomeControl()
       var homeControlDiv = document.createElement('div');
       var homeControl = new HomeControl(homeControlDiv, map);
       //  homeControlDiv.index = 1;
       map.controls[google.maps.ControlPosition.TOP_RIGHT].push(homeControlDiv);
       
     }
     google.maps.event.addDomListener(window, 'load', initialize);
    </script>
    
  </head>
  <body>
    <%= docs.city %>
    <div id='form-search'>
      <form action="/search" method="get" accept-charset="utf-8">
	<div id='q'>
	  <input type="search" name="q" />
	</div>
	
	<div id='search-button'>
	  <input type='submit' value='search' />
	</div>
      </form>
    </div>
    <div id="googleMap" style="width:800px;height:600px;"></div>
    
    
    
    <p id="demo">Click the button to get your coordinates:</p>
    <button onclick="getLocation()">Try It</button>
  </body>
</html>
